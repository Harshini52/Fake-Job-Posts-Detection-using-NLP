<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>JobGuard | Fake Job Detection System</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Montserrat:wght@700;800&display=swap"
      rel="stylesheet"
    />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Poppins", sans-serif;
      }

      :root {
        --primary: #ff6b8b;
        --secondary: #6a67ce;
        --accent: #36d1dc;
        --accent2: #ff9a3c;
        --danger: #ff4d7e;
        --success: #00d4aa;
        --warning: #ffb74d;
        --dark: #2a2d43;
        --light: #f8f9ff;
        --gray: #a6a9c8;
        --card-bg: rgba(255, 255, 255, 0.95);
        --shadow: rgba(106, 103, 206, 0.15);
        --gradient-1: linear-gradient(135deg, #ff6b8b 0%, #ff9a3c 100%);
        --gradient-2: linear-gradient(135deg, #6a67ce 0%, #36d1dc 100%);
        --gradient-3: linear-gradient(135deg, #00d4aa 0%, #6a67ce 100%);
        --gradient-bg: linear-gradient(135deg, #f8f9ff 0%, #e6e9ff 100%);
      }

      body {
        background: var(--gradient-bg);
        color: var(--dark);
        min-height: 100vh;
        padding: 20px;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }

      /* Navigation */
      .navbar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 20px 0;
        margin-bottom: 30px;
        border-bottom: 2px solid rgba(209, 213, 255, 0.5);
      }

      .nav-logo {
        display: flex;
        align-items: center;
        gap: 15px;
        text-decoration: none;
      }

      .nav-logo-icon {
        background: var(--gradient-1);
        color: white;
        width: 50px;
        height: 50px;
        border-radius: 15px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        box-shadow: 0 8px 20px rgba(255, 107, 139, 0.3);
      }

      .nav-logo-text {
        font-family: "Montserrat", sans-serif;
        font-size: 1.8rem;
        font-weight: 800;
        background: var(--gradient-1);
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
      }

      .nav-links {
        display: flex;
        gap: 30px;
        align-items: center;
      }

      .nav-link {
        color: var(--dark);
        text-decoration: none;
        font-weight: 600;
        font-size: 1.1rem;
        padding: 10px 20px;
        border-radius: 12px;
        transition: all 0.3s;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .nav-link:hover {
        background: rgba(106, 103, 206, 0.1);
        color: var(--secondary);
        transform: translateY(-2px);
      }

      .nav-link.active {
        background: var(--gradient-2);
        color: white;
        box-shadow: 0 5px 15px rgba(106, 103, 206, 0.3);
      }

      .dashboard-btn {
        background: var(--gradient-2);
        color: white;
        padding: 12px 30px;
        border-radius: 15px;
        text-decoration: none;
        font-weight: 600;
        font-size: 1.1rem;
        display: flex;
        align-items: center;
        gap: 10px;
        transition: all 0.3s;
        box-shadow: 0 8px 20px rgba(106, 103, 206, 0.3);
      }

      .dashboard-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 12px 25px rgba(106, 103, 206, 0.4);
      }

      .admin-btn {
        background: linear-gradient(135deg, #3a56d4 0%, #667eea 100%);
        color: white;
        padding: 12px 30px;
        border-radius: 15px;
        text-decoration: none;
        font-weight: 600;
        font-size: 1.1rem;
        display: flex;
        align-items: center;
        gap: 10px;
        transition: all 0.3s;
        box-shadow: 0 8px 20px rgba(58, 86, 212, 0.3);
      }

      .admin-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 12px 25px rgba(58, 86, 212, 0.4);
      }

      .user-menu {
        position: relative;
      }

      .user-avatar {
        width: 45px;
        height: 45px;
        border-radius: 50%;
        background: var(--gradient-2);
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        cursor: pointer;
        transition: all 0.3s;
        box-shadow: 0 5px 15px rgba(106, 103, 206, 0.3);
      }

      .user-avatar:hover {
        transform: scale(1.1);
      }

      .user-dropdown {
        position: absolute;
        top: 100%;
        right: 0;
        background: var(--card-bg);
        border-radius: 15px;
        padding: 15px 0;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
        min-width: 200px;
        display: none;
        z-index: 1000;
        backdrop-filter: blur(10px);
        border: 2px solid rgba(255, 255, 255, 0.5);
      }

      .user-dropdown a {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 12px 20px;
        color: var(--dark);
        text-decoration: none;
        font-size: 1rem;
        transition: all 0.3s;
      }

      .user-dropdown a:hover {
        background: rgba(106, 103, 206, 0.1);
        color: var(--secondary);
        padding-left: 25px;
      }

      .user-dropdown.show {
        display: block;
        animation: fadeInDown 0.3s ease-out;
      }

      .login-btn {
        background: var(--gradient-2);
        color: white;
        padding: 12px 30px;
        border-radius: 15px;
        text-decoration: none;
        font-weight: 600;
        font-size: 1.1rem;
        display: flex;
        align-items: center;
        gap: 10px;
        transition: all 0.3s;
        box-shadow: 0 8px 20px rgba(106, 103, 206, 0.3);
      }

      .login-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 12px 25px rgba(106, 103, 206, 0.4);
      }

      header {
        text-align: center;
        margin-bottom: 50px;
        animation: fadeInDown 0.8s ease-out;
        position: relative;
      }

      h1 {
        font-family: "Montserrat", sans-serif;
        font-size: 3.2rem;
        background: var(--gradient-1);
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
        margin-bottom: 15px;
        letter-spacing: -0.5px;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
      }

      .subtitle {
        font-size: 1.2rem;
        color: var(--dark);
        max-width: 700px;
        margin: 0 auto 30px;
        opacity: 0.8;
        font-weight: 500;
      }

      .tagline {
        display: inline-block;
        background: var(--gradient-2);
        color: white;
        padding: 10px 25px;
        border-radius: 50px;
        font-weight: 600;
        font-size: 1rem;
        box-shadow: 0 5px 15px rgba(106, 103, 206, 0.3);
      }

      .main-content {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 35px;
        margin-bottom: 50px;
      }

      @media (max-width: 900px) {
        .main-content {
          grid-template-columns: 1fr;
        }
        .navbar {
          flex-direction: column;
          gap: 20px;
        }
        .nav-links {
          flex-wrap: wrap;
          justify-content: center;
        }
      }

      .card {
        background: var(--card-bg);
        border-radius: 25px;
        padding: 35px;
        box-shadow: 0 15px 40px var(--shadow);
        transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        border: none;
        overflow: hidden;
        position: relative;
        backdrop-filter: blur(10px);
      }

      .card:before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 5px;
        background: var(--gradient-1);
      }

      .card:hover {
        transform: translateY(-10px) scale(1.01);
        box-shadow: 0 25px 60px rgba(106, 103, 206, 0.25);
      }

      .card-header {
        display: flex;
        align-items: center;
        margin-bottom: 30px;
        padding-bottom: 20px;
        border-bottom: 2px solid rgba(255, 255, 255, 0.3);
      }

      .card-icon {
        width: 70px;
        height: 70px;
        border-radius: 18px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 32px;
        margin-right: 20px;
        color: white;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
      }

      .image-upload .card-icon {
        background: var(--gradient-1);
      }

      .text-input .card-icon {
        background: var(--gradient-3);
      }

      .card-title {
        font-size: 1.7rem;
        font-weight: 700;
        color: var(--dark);
        margin-bottom: 5px;
      }

      .card-subtitle {
        font-size: 1rem;
        color: var(--gray);
        opacity: 0.9;
      }

      .upload-area {
        border: 3px dashed #d1d5ff;
        border-radius: 20px;
        padding: 50px 30px;
        text-align: center;
        margin-bottom: 25px;
        transition: all 0.3s;
        cursor: pointer;
        background: rgba(248, 249, 255, 0.7);
        position: relative;
        overflow: hidden;
      }

      .upload-area:hover,
      .upload-area.dragover {
        border-color: var(--primary);
        background: rgba(255, 107, 139, 0.05);
        transform: scale(1.02);
      }

      .upload-icon {
        font-size: 60px;
        margin-bottom: 20px;
        background: var(--gradient-2);
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
      }

      .upload-text {
        font-size: 1.3rem;
        margin-bottom: 10px;
        color: var(--dark);
        font-weight: 600;
      }

      .upload-subtext {
        font-size: 1rem;
        color: var(--gray);
        margin-bottom: 20px;
      }

      .file-input {
        display: none;
      }

      .custom-file-button {
        background: var(--gradient-2);
        color: white;
        border: none;
        padding: 15px 35px;
        border-radius: 15px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s;
        display: inline-flex;
        align-items: center;
        gap: 10px;
        font-size: 1.1rem;
        box-shadow: 0 8px 20px rgba(106, 103, 206, 0.3);
        position: relative;
        overflow: hidden;
      }

      .custom-file-button:before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.2),
          transparent
        );
        transition: 0.5s;
      }

      .custom-file-button:hover:before {
        left: 100%;
      }

      .custom-file-button:hover {
        transform: translateY(-3px);
        box-shadow: 0 12px 25px rgba(106, 103, 206, 0.4);
      }

      .textarea-container {
        margin-bottom: 25px;
        position: relative;
      }

      textarea {
        width: 100%;
        padding: 25px;
        border: 2px solid #d1d5ff;
        border-radius: 20px;
        font-size: 1.1rem;
        resize: vertical;
        min-height: 230px;
        transition: all 0.3s;
        background: rgba(248, 249, 255, 0.7);
        color: var(--dark);
      }

      textarea:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 4px rgba(255, 107, 139, 0.15);
        transform: translateY(-2px);
      }

      .detect-button {
        background: var(--gradient-1);
        color: white;
        border: none;
        padding: 18px 40px;
        border-radius: 15px;
        font-size: 1.2rem;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.4s;
        width: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 12px;
        letter-spacing: 0.5px;
        box-shadow: 0 10px 25px rgba(255, 107, 139, 0.3);
        position: relative;
        overflow: hidden;
      }

      .detect-button:after {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.2),
          transparent
        );
        transition: 0.5s;
      }

      .detect-button:hover:after {
        left: 100%;
      }

      .detect-button:hover {
        transform: translateY(-5px) scale(1.03);
        box-shadow: 0 18px 35px rgba(255, 107, 139, 0.4);
      }

      .detect-button:active {
        transform: translateY(-2px);
      }

      /* Loading overlay for form submissions */
      .form-loading {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(255, 255, 255, 0.9);
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 9999;
        backdrop-filter: blur(5px);
      }

      .form-spinner {
        border: 6px solid rgba(255, 107, 139, 0.1);
        border-radius: 50%;
        border-top: 6px solid var(--primary);
        border-right: 6px solid var(--secondary);
        border-bottom: 6px solid var(--accent2);
        width: 70px;
        height: 70px;
        animation: spin 1.5s linear infinite;
        margin: 0 auto 30px;
      }

      .form-loading-content {
        text-align: center;
        background: var(--card-bg);
        padding: 40px;
        border-radius: 25px;
        box-shadow: 0 15px 40px rgba(106, 103, 206, 0.15);
      }

      .form-loading h3 {
        font-size: 1.8rem;
        margin-bottom: 15px;
        background: var(--gradient-2);
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
        font-weight: 700;
      }

      .form-loading p {
        color: var(--gray);
        font-size: 1.1rem;
      }

      .features {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 30px;
        margin-top: 60px;
      }

      .feature-card {
        background: var(--card-bg);
        border-radius: 25px;
        padding: 35px;
        text-align: center;
        box-shadow: 0 15px 40px rgba(106, 103, 206, 0.15);
        transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        border: 2px solid rgba(255, 255, 255, 0.5);
        position: relative;
        overflow: hidden;
      }

      .feature-card:before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 6px;
      }

      .feature-card:hover {
        transform: translateY(-10px) scale(1.05);
        box-shadow: 0 25px 60px rgba(106, 103, 206, 0.25);
      }

      .feature-1:before {
        background: var(--gradient-1);
      }

      .feature-2:before {
        background: var(--gradient-2);
      }

      .feature-3:before {
        background: var(--gradient-3);
      }

      .feature-icon {
        width: 90px;
        height: 90px;
        border-radius: 25px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 40px;
        margin: 0 auto 25px;
        color: white;
        box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
      }

      .feature-1 .feature-icon {
        background: var(--gradient-1);
      }

      .feature-2 .feature-icon {
        background: var(--gradient-2);
      }

      .feature-3 .feature-icon {
        background: var(--gradient-3);
      }

      .feature-card h3 {
        font-size: 1.5rem;
        font-weight: 700;
        margin-bottom: 15px;
        color: var(--dark);
      }

      .feature-card p {
        color: var(--gray);
        line-height: 1.6;
      }

      footer {
        text-align: center;
        margin-top: 80px;
        padding-top: 40px;
        border-top: 2px solid rgba(209, 213, 255, 0.5);
        color: var(--dark);
        font-size: 1rem;
        opacity: 0.8;
      }

      /* Animations */
      @keyframes fadeInDown {
        from {
          opacity: 0;
          transform: translateY(-40px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(40px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes slideInLeft {
        from {
          opacity: 0;
          transform: translateX(-50px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      @keyframes slideInRight {
        from {
          opacity: 0;
          transform: translateX(50px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      @keyframes popIn {
        0% {
          opacity: 0;
          transform: scale(0.8);
        }
        70% {
          transform: scale(1.05);
        }
        100% {
          opacity: 1;
          transform: scale(1);
        }
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      @keyframes pulse {
        0% {
          transform: scale(1);
          box-shadow: 0 10px 25px rgba(255, 107, 139, 0.3);
        }
        50% {
          transform: scale(1.05);
          box-shadow: 0 15px 35px rgba(255, 107, 139, 0.5);
        }
        100% {
          transform: scale(1);
          box-shadow: 0 10px 25px rgba(255, 107, 139, 0.3);
        }
      }

      @keyframes shine {
        0% {
          transform: translateX(-100%);
        }
        100% {
          transform: translateX(100%);
        }
      }

      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .pulse {
        animation: pulse 2s infinite;
      }

      .floating-shapes {
        position: absolute;
        width: 100%;
        height: 100%;
        top: 0;
        left: 0;
        pointer-events: none;
        z-index: -1;
        overflow: hidden;
      }

      .shape {
        position: absolute;
        border-radius: 50%;
        opacity: 0.1;
        animation: float 20s infinite linear;
      }

      .shape-1 {
        width: 300px;
        height: 300px;
        background: var(--primary);
        top: -150px;
        right: -150px;
        animation-delay: 0s;
      }

      .shape-2 {
        width: 200px;
        height: 200px;
        background: var(--secondary);
        bottom: -100px;
        left: -100px;
        animation-delay: 5s;
      }

      .shape-3 {
        width: 150px;
        height: 150px;
        background: var(--accent);
        top: 50%;
        right: 10%;
        animation-delay: 10s;
      }

      @keyframes float {
        0% {
          transform: translateY(0) rotate(0deg);
        }
        50% {
          transform: translateY(-20px) rotate(180deg);
        }
        100% {
          transform: translateY(0) rotate(360deg);
        }
      }

      /* Alert messages */
      .alert {
        padding: 15px 20px;
        border-radius: 10px;
        margin-bottom: 20px;
        display: flex;
        align-items: center;
        gap: 10px;
        animation: slideIn 0.3s ease-out;
      }

      .alert-error {
        background: rgba(255, 77, 126, 0.1);
        border-left: 4px solid var(--danger);
        color: var(--danger);
      }

      .alert-success {
        background: rgba(0, 212, 170, 0.1);
        border-left: 4px solid var(--success);
        color: var(--success);
      }

      @keyframes slideIn {
        from {
          transform: translateY(-10px);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }

      /* Admin badge */
      .admin-badge {
        display: inline-flex;
        align-items: center;
        gap: 5px;
        background: linear-gradient(135deg, #3a56d4 0%, #667eea 100%);
        color: white;
        padding: 4px 10px;
        border-radius: 10px;
        font-size: 0.8rem;
        font-weight: 600;
        margin-left: 10px;
        vertical-align: middle;
      }

      .admin-avatar {
        background: linear-gradient(135deg, #3a56d4 0%, #667eea 100%) !important;
      }
    </style>
  </head>
  <body>
    <!-- Form Loading Overlay -->
    <div class="form-loading" id="formLoading">
      <div class="form-loading-content">
        <div class="form-spinner"></div>
        <h3>Analyzing Job Posting...</h3>
        <p>Our AI is examining the content for scam indicators</p>
      </div>
    </div>

    <div class="floating-shapes">
      <div class="shape shape-1"></div>
      <div class="shape shape-2"></div>
      <div class="shape shape-3"></div>
    </div>

    <div class="container">
      <!-- Navigation -->
      <nav class="navbar">
        <a href="{{ url_for('index') }}" class="nav-logo">
          <div class="nav-logo-icon">
            <i class="fas fa-shield-alt"></i>
          </div>
          <div class="nav-logo-text">JobGuard</div>
        </a>

        <div class="nav-links">
          <a href="{{ url_for('index') }}" class="nav-link active">
            <i class="fas fa-home"></i> Home
          </a>
          <a href="{{ url_for('dashboard') }}" class="dashboard-btn">
            <i class="fas fa-tachometer-alt"></i> Dashboard
          </a>
          
          <!-- Show Admin Dashboard button if user is admin -->
          {% if session.get('is_admin') %}
          <a href="{{ url_for('admin_dashboard') }}" class="admin-btn">
            <i class="fas fa-user-shield"></i> Admin Dashboard
          </a>
          {% endif %}

          {% if session.get('user_id') %}
          <div class="user-menu">
            <div class="user-avatar {{ 'admin-avatar' if session.get('is_admin') else '' }}" id="userAvatar">
              {% if session.get('first_name') %} 
                {{ session.get('first_name')[0]|upper }} 
              {% else %}
                <i class="fas fa-user-circle"></i>
              {% endif %}
            </div>
            <div class="user-dropdown" id="userDropdown">
              <a href="#">
                <i class="fas fa-user"></i> {{ session.get('first_name', 'User') }}
                {% if session.get('is_admin') %}
                <span class="admin-badge">
                  <i class="fas fa-crown"></i> Admin
                </span>
                {% endif %}
              </a>
              <a href="{{ url_for('dashboard') }}">
                <i class="fas fa-tachometer-alt"></i> My Dashboard
              </a>
              {% if session.get('is_admin') %}
              <a href="{{ url_for('admin_dashboard') }}">
                <i class="fas fa-user-shield"></i> Admin Panel
              </a>
              {% endif %}
              <a href="#">
                <i class="fas fa-cog"></i> Settings
              </a>
              <a href="{{ url_for('logout') }}">
                <i class="fas fa-sign-out-alt"></i> Logout
              </a>
            </div>
          </div>
          {% else %}
          <a href="{{ url_for('login') }}" class="login-btn">
            <i class="fas fa-sign-in-alt"></i> Login
          </a>
          {% endif %}
        </div>
      </nav>

      <header>
        <h1>JobGuard Detection</h1>
        <p class="subtitle">
          Advanced AI-powered system to detect fake job postings and protect job
          seekers from employment scams
        </p>
        <div class="tagline">
          <i class="fas fa-bolt"></i> Real-time Detection • 99% Accuracy • Free
          Forever
        </div>
      </header>

      <!-- Flash Messages -->
      {% with messages = get_flashed_messages(with_categories=true) %} 
      {% if messages %} 
        {% for category, message in messages %}
        <div class="alert alert-{{ 'error' if category == 'danger' else category }}">
          <i class="fas fa-{% if category == 'success' %}check-circle{% else %}exclamation-circle{% endif %}"></i>
          {{ message }}
        </div>
        {% endfor %} 
      {% endif %} 
      {% endwith %} 
      
      {% if not session.get('user_id') %}
      <div class="card" style="text-align: center; padding: 50px">
        <h2 style="margin-bottom: 20px; color: var(--dark)">
          Please Login to Continue
        </h2>
        <p style="margin-bottom: 30px; color: var(--gray)">
          You need to be logged in to use the JobGuard detection system.
        </p>
        <div style="display: flex; gap: 20px; justify-content: center">
          <a href="{{ url_for('login') }}" class="login-btn" style="width: auto">
            <i class="fas fa-sign-in-alt"></i> Login
          </a>
          <a href="{{ url_for('register') }}" class="dashboard-btn" style="width: auto">
            <i class="fas fa-user-plus"></i> Register
          </a>
        </div>
      </div>
      {% else %}
      <div class="main-content">
        <!-- Image Upload Card -->
        <div class="card image-upload">
          <div class="card-header">
            <div class="card-icon">
              <i class="fas fa-image"></i>
            </div>
            <div>
              <h3 class="card-title">Upload Job Post Image</h3>
              <p class="card-subtitle">
                Upload a screenshot or image of a job posting
              </p>
            </div>
          </div>

          <form
            id="imageForm"
            method="POST"
            enctype="multipart/form-data"
            action="{{ url_for('detect') }}"
            onsubmit="return validateImageForm()"
          >
            <input type="hidden" name="type" value="image" />
            <div class="upload-area" id="dropArea">
              <div class="upload-icon">
                <i class="fas fa-cloud-upload-alt"></i>
              </div>
              <p class="upload-text">Drag & drop your image here</p>
              <p class="upload-subtext">or click to browse files</p>
              <p class="upload-subtext">Supports: JPG, PNG, GIF (Max 5MB)</p>
              <input
                type="file"
                id="fileInput"
                class="file-input"
                name="image"
                accept="image/*"
                required
              />
              <label for="fileInput" class="custom-file-button">
                <i class="fas fa-folder-open"></i> Choose Image
              </label>
            </div>

            <div
              class="selected-file"
              id="selectedFile"
              style="
                display: none;
                margin-bottom: 25px;
                padding: 15px;
                background: rgba(248, 249, 255, 0.7);
                border-radius: 15px;
                border: 2px dashed #d1d5ff;
              "
            >
              <p
                style="
                  display: flex;
                  align-items: center;
                  gap: 10px;
                  color: var(--dark);
                  font-weight: 600;
                "
              >
                <i
                  class="fas fa-file-image"
                  style="color: var(--primary); font-size: 1.2rem"
                ></i>
                <span id="fileName"></span>
                <span id="fileSize" style="color: var(--gray)"></span>
                <button
                  type="button"
                  id="clearFile"
                  style="
                    margin-left: auto;
                    background: none;
                    border: none;
                    color: var(--danger);
                    cursor: pointer;
                  "
                >
                  <i class="fas fa-times"></i>
                </button>
              </p>
            </div>

            <button type="submit" class="detect-button pulse">
              <i class="fas fa-search"></i> Detect from Image
            </button>
          </form>
        </div>

        <!-- Text Input Card -->
        <div class="card text-input">
          <div class="card-header">
            <div class="card-icon">
              <i class="fas fa-file-alt"></i>
            </div>
            <div>
              <h3 class="card-title">Enter Job Description</h3>
              <p class="card-subtitle">
                Paste the job description text directly
              </p>
            </div>
          </div>

          <form id="textForm" method="POST" action="{{ url_for('detect') }}" onsubmit="return validateTextForm()">
            <input type="hidden" name="type" value="text" />
            <div class="textarea-container">
              <textarea
                name="job_text"
                id="jobText"
                placeholder="Paste the job description here... 
Example: 'We are hiring for a remote data entry position. No experience required. Earn $5000 per month working from home. Send your personal details to...'"
                required
              ></textarea>
            </div>

            <button type="submit" class="detect-button">
              <i class="fas fa-search"></i> Detect from Text
            </button>
          </form>
        </div>
      </div>

      <!-- Features Section -->
      <div class="features">
        <div class="feature-card feature-1">
          <div class="feature-icon">
            <i class="fas fa-robot"></i>
          </div>
          <h3>AI-Powered Analysis</h3>
          <p>
            Uses advanced machine learning algorithms to identify fraudulent
            patterns with 99% accuracy.
          </p>
        </div>

        <div class="feature-card feature-2">
          <div class="feature-icon">
            <i class="fas fa-bolt"></i>
          </div>
          <h3>Real-Time Detection</h3>
          <p>
            Get instant results with our high-speed processing. No waiting for
            lengthy analysis.
          </p>
        </div>

        <div class="feature-card feature-3">
          <div class="feature-icon">
            <i class="fas fa-shield-alt"></i>
          </div>
          <h3>Comprehensive Protection</h3>
          <p>
            Detects 50+ types of job scams including phishing, advance-fee
            fraud, and identity theft.
          </p>
        </div>
      </div>
      {% endif %}

      <footer>
        <p style="font-size: 1.1rem; margin-bottom: 10px; font-weight: 600">
          JobGuard &copy; 2025 | Fake Job Detection System
        </p>
        <p style="margin-bottom: 15px">
          Protecting Job Seekers Worldwide • 100% Free
        </p>
        <p style="font-size: 0.9rem">
          <i class="fas fa-info-circle"></i> This tool uses AI to analyze job
          postings but should not be the sole basis for employment decisions.
        </p>
      </footer>
    </div>

    <script>
      // Check if user is logged in
      const isLoggedIn = {{ 'true' if session.get('user_id') else 'false' }};
      const isAdmin = {{ 'true' if session.get('is_admin') else 'false' }};

      if (!isLoggedIn) {
          document.querySelector('.main-content')?.style.display = 'none';
          document.querySelector('.features')?.style.display = 'none';
      }

      // File upload handling
      const fileInput = document.getElementById('fileInput');
      const dropArea = document.getElementById('dropArea');
      const selectedFile = document.getElementById('selectedFile');
      const fileName = document.getElementById('fileName');
      const fileSize = document.getElementById('fileSize');
      const clearFileBtn = document.getElementById('clearFile');
      const formLoading = document.getElementById('formLoading');

      if (dropArea && fileInput) {
          dropArea.addEventListener('dragover', (e) => {
              e.preventDefault();
              dropArea.classList.add('dragover');
          });

          dropArea.addEventListener('dragleave', () => {
              dropArea.classList.remove('dragover');
          });

          dropArea.addEventListener('drop', (e) => {
              e.preventDefault();
              dropArea.classList.remove('dragover');

              if (e.dataTransfer.files.length) {
                  fileInput.files = e.dataTransfer.files;
                  updateFileInfo();
              }
          });

          dropArea.addEventListener('click', () => {
              fileInput.click();
          });
      }

      if (fileInput) {
          fileInput.addEventListener('change', updateFileInfo);
      }

      if (clearFileBtn) {
          clearFileBtn.addEventListener('click', (e) => {
              e.preventDefault();
              e.stopPropagation();
              if (fileInput) fileInput.value = '';
              if (selectedFile) selectedFile.style.display = 'none';
          });
      }

      function updateFileInfo() {
          if (fileInput && fileInput.files.length > 0) {
              const file = fileInput.files[0];
              if (fileName) fileName.textContent = file.name;

              const sizeInMB = (file.size / (1024*1024)).toFixed(2);
              if (fileSize) fileSize.textContent = `(${sizeInMB} MB)`;

              if (selectedFile) selectedFile.style.display = 'block';
          } else {
              if (selectedFile) selectedFile.style.display = 'none';
          }
      }

      // Form validation and submission
      function validateImageForm() {
          if (!fileInput.files.length) {
              showAlert('Please select an image file to upload.', 'error');
              return false;
          }

          const file = fileInput.files[0];
          const fileSizeMB = file.size / (1024 * 1024);
          
          if (fileSizeMB > 5) {
              showAlert('File size exceeds 5MB limit. Please choose a smaller file.', 'error');
              return false;
          }

          showFormLoading();
          return true;
      }

      function validateTextForm() {
          const textArea = document.getElementById('jobText');
          
          if (!textArea.value.trim()) {
              showAlert('Please enter job description text to analyze.', 'error');
              return false;
          }

          if (textArea.value.trim().length < 10) {
              showAlert('Please enter at least 10 characters for analysis.', 'error');
              return false;
          }

          showFormLoading();
          return true;
      }

      function showFormLoading() {
          if (formLoading) {
              formLoading.style.display = 'flex';
          }
      }

      function showAlert(message, type) {
          const alertDiv = document.createElement('div');
          alertDiv.className = `alert alert-${type}`;
          alertDiv.innerHTML = `<i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-circle'}"></i> ${message}`;
          
          const container = document.querySelector('.container');
          if (container) {
              const navbar = container.querySelector('.navbar');
              if (navbar) {
                  container.insertBefore(alertDiv, navbar.nextSibling);
              } else {
                  container.prepend(alertDiv);
              }
              
              setTimeout(() => {
                  alertDiv.style.opacity = '0';
                  alertDiv.style.transform = 'translateY(-10px)';
                  setTimeout(() => alertDiv.remove(), 300);
              }, 5000);
          }
      }

      // User dropdown toggle
      const userAvatar = document.getElementById('userAvatar');
      const userDropdown = document.getElementById('userDropdown');

      if (userAvatar && userDropdown) {
          userAvatar.addEventListener('click', function(e) {
              e.stopPropagation();
              userDropdown.classList.toggle('show');
          });

          document.addEventListener('click', function(e) {
              if (!userAvatar.contains(e.target) && !userDropdown.contains(e.target)) {
                  userDropdown.classList.remove('show');
              }
          });
      }

      // Auto-hide flash messages
      setTimeout(() => {
          const alerts = document.querySelectorAll('.alert');
          alerts.forEach(alert => {
              alert.style.opacity = '0';
              alert.style.transform = 'translateY(-10px)';
              setTimeout(() => alert.remove(), 300);
          });
      }, 5000);

      // Add sample text on page load
      document.addEventListener('DOMContentLoaded', function() {
          const textarea = document.getElementById('jobText');
          if (textarea && textarea.value.trim() === '') {
              textarea.value = `Work from home opportunity! Earn $5000 per month. No experience required. Immediate start. 

We are urgently hiring for data entry positions. Send your personal details including SSN and bank information to start immediately. 

Requirements: None
Salary: $5000/month
Contact: Send your resume to hr@gmail.com

Please send registration fee of $50 to secure your position. Limited seats available!`;
          }
      });
    </script>
  </body>
</html>